datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model OrdemProducao {
  id                  String   @id
  numeroOP            String   @unique
  descricaoProduto    String
  quantidadeProduzida Int
  status              String
  criadoEm            DateTime @default(now())

  eventos        EventoOP[]
  produtosFinais ProdutoFinal[]
}

model EventoOP {
  id            String   @id
  opId          String
  etapa         String
  tipo          String
  funcionarioId String
  criadoEm      DateTime @default(now())

  ordemProducao OrdemProducao @relation(fields: [opId], references: [id])
}

model ProdutoFinal {
  id           String   @id
  opId         String
  serie        String   @unique
  criadoEm     DateTime @default(now())

  ordemProducao OrdemProducao @relation(fields: [opId], references: [id])
  subprodutos   Subproduto[]
}

model Subproduto {
  id                 String   @id
  produtoFinalId     String
  opNumeroSubproduto String
  etiquetaId         String   @unique
  funcionarioId      String
  quantidade         Int
  criadoEm           DateTime @default(now())

  produtoFinal ProdutoFinal @relation(fields: [produtoFinalId], references: [id])
}

